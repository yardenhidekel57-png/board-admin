<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>  注转</title>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; padding: 15px; margin: 0; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h2 { color: #1e3a8a; margin: 0 0 15px 0; font-size: 20px; }
        textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #0ea5e9; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .msg-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee; gap: 10px; }
        .msg-text { flex: 1; font-size: 14px; color: #334155; }
        .del-btn { background: #ef4444; width: auto; padding: 5px 10px; font-size: 12px; margin: 0; }
        #status { text-align: center; font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div id="status">注 转...</div>

    <div class="card">
        <h2> 注 砖</h2>
        <textarea id="msgInput" rows="3" placeholder="拽 注..."></textarea>
        <button onclick="sendUpdate()">砖 </button>
    </div>

    <div class="card">
        <h2> 注转 驻注转</h2>
        <div id="messagesList">注 注转...</div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxRkk7x_2EbkzPbfwobm_6pkOa7MkPrO1wLbra16MhG3tcXctjy5hYANA0jo3IS4kM/exec'; // 砖  祝 拽砖专 砖

       async function loadMessages() {
    const list = document.getElementById('messagesList');
    try {
        // 住驻转 No-Cache  注 注 砖 转 砖
       const res = await fetch(SCRIPT_URL, {
    method: 'GET',
    redirect: 'follow' // 砖   注拽祝 转 驻转 砖 
});
        const data = await res.json();
        
        list.innerHTML = data.length ? '' : ' 注转 ';
        
        data.forEach(msg => {
            list.innerHTML += `
                <div class="msg-item">
                    <span class="msg-text">${msg.text}</span>
                    <button class="del-btn" onclick="deleteMessage(${msg.id})">拽</button>
                </div>
            `;
        });
        document.getElementById('status').innerText = "";
    } catch (e) {
        //  砖 砖, 住 爪 转    拽专
        console.error(e);
        list.innerHTML = "砖 专 转.  砖拽砖专 转拽.";
        document.getElementById('status').innerText = "砖转 转拽砖专转";
    }
}
        async function sendUpdate() {
            const text = document.getElementById('msgInput').value;
            if(!text) return;
            await apiCall({ type: 'message', text: text });
            document.getElementById('msgInput').value = "";
            loadMessages();
        }

        async function deleteMessage(id) {
            if(!confirm("拽 注 ?")) return;
            await apiCall({ type: 'delete_row', rowId: id });
            loadMessages();
        }

        async function apiCall(payload) {
            document.getElementById('status').innerText = "注...";
            try {
                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(payload)
                });
                document.getElementById('status').innerText = "注!";
                setTimeout(() => document.getElementById('status').innerText = "", 2000);
            } catch (e) {
                alert("砖 转拽砖专转");
            }
        }

        loadMessages(); // 注 专砖转
    </script>
</body>
</html>



